\documentclass[12pt,a4paper]{article}

\usepackage[OT4]{polski}
\usepackage[cp1250]{inputenc}
\usepackage{ifthen}
\usepackage{anysize}
\usepackage{geometry}
\usepackage{fancyhdr}
\pagestyle{fancy}
\headheight 1cm
\marginsize{2cm}{2cm}{0.5cm}{2cm}
\lhead{SOI - laboratorium nr 4 - monitory} 
\rhead{Jakub Król, R3I2}
\fancyheadoffset{0cm}
% komendy
\newcounter{ind}
\newcommand*{\wylicz}[2]{#1_1,#1_2,\dots,#1_{#2}} 
\newcommand*{\ndots}[1]{
\setcounter{ind}{1}
\whiledo{\value{ind}<#1}{. \stepcounter{ind}}} 

\renewcommand{\arraystretch}{1.5}
%\makeatletter
%\renewcommand\paragraph{\@startsection{paragraph}{4}{\z@}%
%  {-3.25ex\@plus -1ex \@minus -.2ex}%
%  {1.5ex \@plus .2ex}%
%  {\normalfont\normalsize\bfseries}}
%\makeatother
%

\begin{document}

% ------ TREŒÆ ----------------------
\section{Treœæ zadania}
Implementacja "bufora komunikacyjnego" - struktury danych mieszcz¹cej maksymalnie \texttt{M} elementów, pozwalaj¹cej na  wyjmowanie elementów w kolejnoœci umieszczania i odwrotnej. Nale¿y zadbaæ o zabezpieczenie przed czytaniem z pustego bufora, zapisem do pe³nego bufora i jednoczesnym u¿yciem bufora przez ró¿ne procesy.

Bufor komunikacyjny o takiej samej funkcjonalnoœci jak w poprzednim zadaniu, ma zostaæ zrealizowany za pomoc¹ monitorów.

% ------ ZA£O¯ENIA ------------------
\section{Za³o¿enia}
\begin{enumerate}
\item Wielkoœæ kolejki i segment pamiêci wspó³dzielonej s¹ okreœlane przy inicjalizacji programu 
\item Typ elementów jest okreœlony przed rozpoczêciem implementacji
\item Wykorzystywane s¹ elementy kodu napisanego przy implementacji poprzedniego æwiczenia.
\end{enumerate}


% ------- REALIZACJA ----------------
\section{Realizacja}
Do zrealizowania zadania planujê stworzyæ i wykorzystaæ nastêpuj¹ce obiekty: 
\subsection{\texttt{Semaphore}}
\paragraph{Obiekt semafora,} bêd¹cy interfejsem dostêpu do funkcji systemowych semafora. Potrzebny do blokowania wejœcia do monitora i czekania na warunek. 
\subsection{\texttt{Condition}}
\paragraph{Obiekt warunku,} zliczaj¹cy oczekuj¹cych na jego spe³nienie. Ma za zadanie zawieszaæ i odwieszaæ procesy w zale¿noœci od spe³nienia warunku.
\subsection{\texttt{Monitor}}
\paragraph{Obiekt monitora,} zabezpieczaj¹cy przed jednoczesnym dostêpem do tego samego zasobu i obs³uguj¹cy zawieszanie i odwieszanie procesów w zale¿noœci od zadanego warunku (poprzez obiekt \texttt{Condition})
\subsection{\texttt{Queue}}
\paragraph{Obiekt kolejki,} obs³uguj¹cy funkcje umieszczania i usuwania elementów w pamiêci wspó³dzielonej. Funkcje te s¹ niezabezpieczone przed jednoczesnym dostêpem.
\subsection{\texttt{Buffer}}
\paragraph{Obiekt bufora,} obs³uguj¹cy funkcje kolejki, ale zabezpieczaj¹cy je przed jednoczesnym dostêpem za pomoc¹ monitora.

% ------- IMPLEMENTACJA ------------ 
\section{Planowana implementacja}
Do zaimplementowania powy¿szych funkcji potrzebne bêd¹ nastêpuj¹ce elementy:
\subsection{\texttt{Semaphore}}
Modu³ \texttt{sem\_func} z poprzedniego æwiczenia zamieniony w klasê implementuj¹c¹ semafor. Metody:
\begin{itemize}
\item \texttt{proberen()}
Jeœli semafor jest opuszczony zawiesza proces. Jeœli nie, przepuszcza proces i opuszcza semafor.
\item \texttt{verhogen()}
Podnosi semafor
\end{itemize}

\subsection{\texttt{Condition}}
Klasa umo¿liwiaj¹ca operowanie na warunkach. \\

Atrybuty:

\begin{itemize}
\item \texttt{waitCount} - licznik oczekuj¹cych procesów
\item \texttt{internalSemaphore} - semafor kontroluj¹cy spe³nienie warunku
\end{itemize}

Metody:

\begin{itemize}
\item \texttt{wait()}
Inkrementuje licznik i opuszcza semafor
\item \texttt{signal()}
Jeœli s¹ oczekuj¹cy, dekrementuje licznik i podnosi semafor
\end{itemize}

\subsection{\texttt{Monitor}}
Klasa chroni przed jednoczesnym dostêpem do swoich metod.

Atrybuty:

\begin{itemize}
\item \texttt{mutext} - obiekt klasy \texttt{Semaphore} zabezpieczaj¹cy przed jednoczesnym dostêpem
\end{itemize}

Metody:

\begin{itemize}
\item \texttt{enter()}
Blokuje dostêp za pomoc¹ semafora \texttt{mutex}
\item \texttt{leave()}
Odblokowuje dostêp za pomoc¹ semafora \texttt{mutex}
\end{itemize}

\subsection{\texttt{Queue}}
Klasa implementuj¹ca funkcje modu³u \texttt{Queue} z poprzedniego æwiczenia, posiadaj¹ce analogiczne atrybuty:
\begin{itemize}
\item \texttt{size} - rozmiar
\item \texttt{id} - id pamiêci wspó³dzielonej
\item \texttt{list} - miejsce przechowywania elementów
\end{itemize}
i metody:
\begin{itemize}
\item \texttt{push()}
\item \texttt{popBack()}
\item \texttt{popFront()}
\item \texttt{print()} - zamiast \texttt{list()}
\item \texttt{increment()}
\item \texttt{decrement()}
\end{itemize}
Dodane zostan¹ jeszcze dwie metody:
\begin{itemize}
\item \texttt{getSize()}
Zwracaj¹ca rozmiar kolejki (sta³y, podany przy uruchomieniu programu)
\item \texttt{getCount()}
Zwracaj¹ca iloœæ elementów aktualnie znajduj¹cych siê w kolejce
\end{itemize}

\subsection{\texttt{Buffer}}
Klasa bufora zapewniaj¹ca bezpieczny dostêp do kolejki:
Atrybuty:
\begin{itemize}
\item \texttt{*notFull} - wskaŸnik na obiekt klasy \texttt{Condition} okreœlaj¹cy warunek zape³nienia listy
\item \texttt{*notEmpty} - wskaŸnik na obiekt klasy \texttt{Condition} okreœlaj¹cy warunek pustoœci listy
\item \texttt{*queue} - wskaŸnik na obiekt klasy \texttt{Queue} z kolejk¹ danego bufora
\end{itemize}

Metody bêd¹ analogiczne do modu³u bufora z poprzedniego æwiczenia:

\begin{itemize}
\item \texttt{push()}
\item \texttt{popBack()}
\item \texttt{popFront()}
\end{itemize}

W celu zapewnienia bezpiecznego dostêpu do kolejki, klasa u¿ywa mechanizmu monitora do zablokowania u¿ytkowania przez wiele procesów na raz. Dlatego klasa ta dziedziczy po klasie \texttt{Monitor}

% --------------- TESTY ------------------
\section{Testowanie}
Tak jak w poprzednim æwiczeniu konieczne jest przetestowanie nastêpuj¹cych aspektów implementacji:
\begin{itemize}
\item jednoczesne pisanie do bufora kilku producentów
\item jednoczesne pisanie i czytanie przez producenta i konsumenta
\item jednoczesne czytanie przez kilku konsumentów
\item zapisywanie do pe³nego bufora
\item czytanie pustego bufora
\item czytanie i pisanie w prawid³owych warunkach
\end{itemize}

Testy zamierzam zrealizowaæ za pomoc¹ jednego programu, który korzysta z bufora w oddzielnych w¹tkach. Dostêp do bufora mo¿liwy jest przez instancjê klasy \texttt{Buffer}.
\end{document}
